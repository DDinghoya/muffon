<template>
  <div
    class="track-player-panel"
    :class="{
      inverted: isDarkMode
    }"
  >
    <PlayButtonSection
      :track-data="trackData"
    />

    <VisualizerSection
      :track-id="trackId"
    />

    <DurationSection
      v-if="isRenderDuration"
      :duration="duration"
    />

    <SourceSection
      v-if="isAudioPresent"
      :source-id="sourceId"
    />
  </div>
</template>

<script>
import {
  mapState
} from 'vuex'
import PlayButtonSection from './BaseTrackPlayerPanel/PlayButtonSection.vue'
import VisualizerSection from './BaseTrackPlayerPanel/VisualizerSection.vue'
import DurationSection from './BaseTrackPlayerPanel/DurationSection.vue'
import SourceSection from './BaseTrackPlayerPanel/SourceSection.vue'

export default {
  name: 'BaseTrackPlayerPanel',
  components: {
    PlayButtonSection,
    VisualizerSection,
    DurationSection,
    SourceSection
  },
  props: {
    trackData: Object
  },
  computed: {
    ...mapState(
      'layout',
      [
        'isDarkMode'
      ]
    ),
    trackId () {
      return this.trackData.player_id
    },
    isRenderDuration () {
      return (
        this.duration &&
          this.duration !== '00:00'
      )
    },
    duration () {
      return this.trackData.duration
    },
    isAudioPresent () {
      return !!this.trackData.audio?.present
    },
    sourceId () {
      return this.trackData.audio.source_id
    }
  }
}
</script>

<style lang="sass" scoped>
.track-player-panel
  @extend .d-flex
  height: $trackPagePlayerPanelHeight
  ::v-deep(.track-visualiser-container)
    border-left: $border
  ::v-deep(.track-duration)
    border-left: $border
  ::v-deep(.track-source)
    border-left: $border
  &.inverted
    border-top: $borderInverted
    ::v-deep(.track-visualiser-container)
      border-left: $borderInverted !important
    ::v-deep(.track-duration)
      border-left: $borderInverted !important
    ::v-deep(.track-source)
      border-left: $borderInverted !important
</style>
